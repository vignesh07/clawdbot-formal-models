SPECIFICATION Spec
INVARIANT Inv_SharedNodesRunSafe

CONSTANTS
  Tools = {"nodes.run"}
  NodesRunTool = "nodes.run"
  RequestIds = {"r1","r2"}

  SessionType = "shared"

  \* shared policy mistakenly allows nodes.run, but approvals are required
  PolicyAllowShared = {"nodes.run"}
  PolicyAllowMain = {"nodes.run"}

  NodeCommands = {"system.run"}
  NodesRunCommand = "system.run"

  PlatformDefaults = {"system.run"}
  ExtraAllow = {}
  Deny = {}
  DeclaredByNode = {"system.run"}

  ApprovalRequired = TRUE

  MaxQueueLen = 2
  MaxExecLen = 2
